# Обработка и визуализация данных о пассажирах Титаника <a href="https://opensource.org/licenses/MIT"><img src="https://img.shields.io/badge/License-MIT-yellow.svg" alt="MIT-License image"></a>

**Проект по дисциплине:** МДК 13.01 Основы применения методов искусственного интеллекта в программировании

**Практическое занятие №3:** Обработка пропущенных значений и визуализация данных.


## 1. Введение

В рамках данного практического занятия была выполнена обработка пропущенных значений в данных о пассажирах Титаника с использованием различных методов, а также визуализация данных с применением библиотек Python Matplotlib и Seaborn.  Целью работы являлось получение навыков работы с пропущенными данными и визуализации для их анализа и представления.


## 2. Методика и подходы

### 2.1. Методы

В ходе работы применялись следующие методы обработки пропущенных значений:

- **Удаление строк с пропущенными значениями:**  Простой, но потенциально приводящий к потере информации, метод.
- **Заполнение пропущенных значений средним/медианным:**  Заполнение пропущенных значений статистикой по столбцу.
- **Интерполяция:** Заполнение пропущенных значений на основе существующих данных.
- **KNN Imputation:** Заполнение пропущенных значений с использованием алгоритма K ближайших соседей.
- **Предсказание с использованием линейной регрессии:**  Использование модели машинного обучения для предсказания пропущенных значений.

Также использовались следующие методы визуализации данных:

- **Тепловая карта:** для визуализации матрицы пропущенных значений.
- **Графики сравнения:** для оценки изменений в данных после применения различных методов обработки пропусков.

### 2.2. Алгоритмы

Для обработки пропущенных значений и построения графиков использовались следующие алгоритмы:

- **Алгоритм удаления строк:**  Простое удаление строк, содержащих `NaN`.
- **Алгоритмы вычисления среднего и медианы:**  Стандартные статистические алгоритмы.
- **Алгоритм линейной интерполяции:** Заполнение пропусков на основе линейной зависимости между соседними точками.
- **Алгоритм KNN Imputation:**  Поиск `k` ближайших соседей для каждой записи с пропущенным значением и заполнение пропусков на основе значений соседей.
- **Алгоритм линейной регрессии:**  Обучение модели линейной регрессии для предсказания пропущенных значений.

### 2.3. Подходы

- **Модульность:**  Код организован в отдельные модули (`data_loader.py`, `missing_data_handler.py`, `feature_engineer.py`, `visualizer.py`, `utils.py`), что улучшает читаемость и облегчает поддержку.
- **Объектно-ориентированное программирование (ООП):**  Использованы классы для представления различных сущностей (загрузчик данных, обработчик пропущенных значений, визуализатор).
- **Функциональное программирование:** Использованы функции для выполнения конкретных задач (например, `print_results`).

### 2.4. Допущения и ограничения

- Предполагается, что URL, указанный для загрузки данных, является доступным и содержит корректные CSV-данные.
- Качество предсказания пропущенных значений с помощью линейной регрессии напрямую зависит от качества и релевантности выбранных предикторов.

### 2.5. Инструменты, библиотеки и технологии

- **Python:** основной язык программирования.
- **Pandas:** для загрузки, обработки и анализа данных.
- **Scikit-learn:** для использования алгоритмов машинного обучения (KNN Imputation, Linear Regression) и предварительной обработки данных (LabelEncoder, StandardScaler).
- **Matplotlib:** для создания статических графиков.
- **Seaborn:** для улучшения визуализации графиков.


## 3. Результаты

### 3.1. Краткое описание данных

Данные были взяты из открытого репозитория Seaborn по ссылке: https://raw.githubusercontent.com/mwaskom/seaborn-data/master/titanic.csv. Формат данных - CSV. Набор данных содержит информацию о пассажирах Титаника, включая их возраст, пол, класс билета, стоимость, выживаемость и другие параметры.  Наличие пропущенных значений в некоторых признаках (в частности, в `age` и `embarked`) требует применения методов обработки пропусков.

### 3.2. Предварительная обработка данных

Выполнена обработка пропущенных значений с использованием различных методов, включая удаление строк, заполнение средним/медианой, интерполяцию, KNN Imputation и предсказание с использованием линейной регрессии. Также выполнено кодирование категориальных признаков и масштабирование числовых признаков для использования в модели линейной регрессии.

### 3.3. Графики и диаграммы

#### 3.3.1. Тепловая карта пропущенных значений

<p align="center">
  <img src="https://github.com/user-attachments/assets/7f44afc9-e409-4f5f-b028-6f2fd02a6414" alt="Тепловая карта пропущенных значений">
</p>

Тепловая карта визуализирует распределение пропущенных значений по признакам. Позволяет увидеть, в каких столбцах больше всего пропусков.

#### 3.3.2. Сравнение распределений после заполнения средним

<p align="center">
  <img src="https://github.com/user-attachments/assets/84aa88ce-4bd4-473d-926b-a7051121effe" alt="Сравнение распределений после заполнения средним">
</p>

График показывает сравнение распределения возраста до и после заполнения пропущенных значений средним.

#### 3.3.3. Сравнение распределений после заполнения медианой

<p align="center">
  <img src="https://github.com/user-images/1234567/example_median_comparison.png" alt="Сравнение распределений после заполнения медианой">
</p>

График показывает сравнение распределения возраста до и после заполнения пропущенных значений медианой.

#### 3.3.4. Сравнение данных до и после интерполяции (fare)

<p align="center">
  <img src="https://github.com/user-images/1234567/example_interpolation_comparison.png" alt="Сравнение данных до и после интерполяции">
</p>

График показывает исходные и интерполированные значения `fare`.

#### 3.3.5.  KNN Imputation (age и fare)

<p align="center">
  <img src="https://github.com/user-images/1234567/example_knn_imputation.png" alt="KNN Imputation">
</p>

График показывает результаты заполнения пропусков с использованием KNN Imputation. (Можно визуализировать распределения `age` и `fare` до и после KNN, или scatter plot `age` vs `fare` до и после).

### 4. Анализ результатов

### 4.1. Вывод консоли

<p align="center">
  <img src="https://github.com/user-attachments/assets/3efb9fc6-3800-4da7-bc79-cc5c66a9f8e2" alt="Консольный_вывод_1">
</p>

<p align="center">
  <img src="https://github.com/user-attachments/assets/26828706-0cbb-488e-bd8a-8b25790d44d5" alt="Консольный_вывод_2">
</p>

<p align="center">
  <img src="https://github.com/user-attachments/assets/07cf8eb1-b2f2-40f6-bf94-8faab66a9b08" alt="Консольный_вывод_3">
</p>

<p align="center">
  <img src="https://github.com/user-attachments/assets/ebec6650-6b3b-4a40-9684-3e1183a01e31" alt="Консольный_вывод_3">
</p>

- Разные методы обработки пропущенных значений оказывают различное влияние на распределение данных.
- Удаление строк с пропущенными значениями может привести к значительной потере данных.
- Заполнение средним или медианой сохраняет размер датасета, но может исказить распределение.
- Интерполяция подходит для данных, где значения изменяются плавно.
- KNN Imputation учитывает значения других признаков при заполнении пропусков.
- Предсказание с использованием линейной регрессии позволяет учесть взаимосвязи между признаками, но требует предварительной подготовки данных (кодирование категориальных признаков, масштабирование).

### 4.2. Обсуждение возможных улучшений

- Использование более сложных моделей машинного обучения для предсказания пропущенных значений (например, Random Forest, Gradient Boosting).
-  Оценка качества заполнения пропущенных значений с использованием кросс-валидации.
-  Анализ влияния различных методов обработки пропущенных значений на результаты последующего анализа данных (например, на точность модели классификации выживаемости).
- Рассмотрение других стратегий выбора предикторов для модели линейной регрессии.

## 5. Заключение

В ходе данного проекта были получены навыки работы с пропущенными данными и визуализации данных с использованием библиотек Python. Были изучены и применены различные методы обработки пропущенных значений, а также проанализировано их влияние на данные. Полученные навыки могут быть применены для решения задач анализа данных в различных областях.

## 6. Лицензия

Этот проект распространяется под лицензией MIT - смотрите файл [LICENSE](LICENSE) для деталей.

## 7. Автор

Бедин Владислав ([MindlessMuse666](https://github.com/MindlessMuse666))
- GitHub: [MindlessMuse666](https://github.com/MindlessMuse666 "Владислав: https://github.com/MindlessMuse666")
- Telegram: [@mindless_muse](t.me/mindless_muse)
- Gmail: [mindlessmuse.666@gmail.com](mindlessmuse.666@gmail.com)
